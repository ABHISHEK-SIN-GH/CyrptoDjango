<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <title>Document</title>
    <style>
      table,
      th,
      td {
        border: 1px solid blue;
        border-collapse: collapse;
        padding: 10px;
        text-align: center;
      }
      th {
        background-color: black;
        color: white;
      }
      td {
        background-color: #96d4d4;
      }
    </style>
  </head>
  <body>

    <h1 class="text-center p-5 bg-success text-dark font-monospace fw-bold">Market Analysis of BTC Cyrpto.</h1>

    <h3 class="text-center mt-4 text-primary font-monospace fw-bold">Market analysis in last week.</h3>

    <div class="overflow-auto mt-4 mb-5">
      <table class="mx-auto">
        <thead>
          <tr>
            <th>Date</th>
            <th>Volume</th>
            <th>Market Cap</th>
            <th>Open</th>
            <th>High</th>
            <th>Low</th>
            <th>Close</th>
          </tr>
        </thead>
        <tbody>
          {% for i in data1 %}
          <tr>
            {% if forloop.counter <= 7 %}
            <td style="background-color:white; color:black;">{{i.d}}</td>
            <td>{{i.v}}</td>
            <td>{{i.m}}</td>
            <td style="background-color:#ffdd00;">{{i.o}}</td>
            <td style="background-color:#a40606;">{{i.c}}</td>
            <td style="background-color:#009ffd;">{{i.l}}</td>
            <td style="background-color:#20bf55;">{{i.h}}</td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <hr />

    <div class="row mx-auto">

      <div class="col-12 col-sm-12 col-md-6">

        <div>
          <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market open analysis in past few days</h5>
          <canvas class="p-3" id="myCharto"></canvas>
        </div>

        <hr />

        <div>
          <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market close analysis in past few days</h5>
          <canvas class="p-3" id="myChartc"></canvas>
        </div>

        <hr />

      </div>

      <div class="col-12 col-sm-12 col-md-6">

        <div>
          <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market low analysis in last few days</h5>
          <canvas class="p-3" id="myChartl"></canvas>
        </div>

        <hr />
        
        <div>
          <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market high analysis in last few days</h5>
          <canvas class="p-3" id="myCharth"></canvas>
        </div>

        <hr />

      </div>

    </div>

    <div class="row mx-auto">

      <div class="col-12 col-sm-12 col-md-6">
        <div>
          <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market analysis of min of data</h5>
          <canvas class="p-3" id="myChart-bmin"></canvas>
        </div>
        <hr />
      </div>

      <div class="col-12 col-sm-12 col-md-6">
        <div>
          <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market analysis of max of data</h5>
          <canvas class="p-3" id="myChart-bmax"></canvas>
        </div>
        <hr />
      </div>

    </div>

    <div class="row mx-auto">
      <div>
        <h5 class="text-center text-primary font-monospace fw-bold mx-5">Market analysis in past few days</h5>
        <canvas class="p-3" id="myChartoclh"></canvas>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>

    <script>
      var dValues = [];
      var oValues = [];
      var hValues = [];
      var lValues = [];
      var cValues = [];
      generateData("{{data|escapejs}}");

      function generateData(data) {
        data = JSON.parse(data);
        for (let x = 0; x < 100; x++) {
          if (x % 5 == 0) {
            oValues.push(data[x]["o"]);
            hValues.push(data[x]["h"]);
            lValues.push(data[x]["l"]);
            cValues.push(data[x]["c"]);
            dValues.push(data[x]["d"]);
          }
        }
      }

      new Chart("myCharto", {
        type: "line",
        data: {
          labels: dValues,
          datasets: [
            {
              data: oValues,
              borderColor: "yellow",
              backgroundColor: "#ffdd00",
              fill: true,
              label: "Open",
            },
          ],
        },
        options: {
          legend: { display: false },
        },
      });

      new Chart("myCharth", {
        type: "line",
        data: {
          labels: dValues,
          datasets: [
            {
              data: hValues,
              borderColor: "green",
              backgroundColor: "#20bf55",
              fill: true,
              label: "High",
            },
          ],
        },
        options: {
          legend: { display: false },
        },
      });

      new Chart("myChartl", {
        type: "line",
        data: {
          labels: dValues,
          datasets: [
            {
              data: lValues,
              borderColor: "red",
              backgroundColor: "#a40606",
              fill: true,
              label: "Low",
            },
          ],
        },
        options: {
          legend: { display: false },
        },
      });

      new Chart("myChartc", {
        type: "line",
        data: {
          labels: dValues,
          datasets: [
            {
              data: cValues,
              borderColor: "blue",
              backgroundColor: "#009ffd",
              fill: true,
              label: "Close",
            },
          ],
        },
        options: {
          legend: { display: false },
        },
      });

      new Chart("myChartoclh", {
        type: "line",
        data: {
          labels: dValues,
          datasets: [
            {
              data: oValues,
              borderColor: "yellow",
              backgroundColor: "#ffdd00",
              fill: false,
              label: "Open",
            },
            {
              data: cValues,
              borderColor: "green",
              backgroundColor: "#20bf55",
              fill: false,
              label: "Close",
            },
            {
              data: lValues,
              borderColor: "red",
              backgroundColor: "#a40606",
              fill: false,
              label: "Low",
            },
            {
              data: hValues,
              borderColor: "blue",
              backgroundColor: "#009ffd",
              fill: false,
              label: "High",
            },
          ],
        },
        options: {
          legend: { display: false },
        },
      });

      minValues = [Math.min(...oValues), Math.min(...cValues), Math.min(...lValues), Math.min(...hValues)];
      maxValues = [Math.max(...oValues), Math.max(...cValues), Math.max(...lValues), Math.max(...hValues)];

      var barColors = ["#ffdd00","#a40606","#009ffd","#20bf55"];
      var labels = ["open","close","low","high"]
      new Chart("myChart-bmin", {
        type: "bar",
        data: {
          labels: labels,
          datasets: [{
            backgroundColor: barColors,
            data: minValues,
            label: "Analysis of data with minimum value"
          }]
        },
        options: {
          legend: {display: false},
          scales: {
            y: {
                beginAtZero: false,
                min: Math.min(...minValues) - 100000,
                }
            }
        }
      });

      new Chart("myChart-bmax", {
        type: "bar",
        data: {
          labels: labels,
          datasets: [{
            backgroundColor: barColors,
            data: maxValues,
            label: "Analysis of data with maximum value"
          }]
        },
        options: {
          legend: {display: false},
          scales: {
            y: {
                beginAtZero: false,
                min: Math.min(...maxValues) - 100000,
                }
            }
        }
      });
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

  </body>
</html>
